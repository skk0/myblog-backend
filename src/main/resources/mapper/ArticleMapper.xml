<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skk.blog.mapper.ArticleMapper">

    <!-- 查询近期文章 -->
    <select id="selectRecentArticles" resultType="article">
        SELECT a.*, c.name as category_name
        FROM article a
        LEFT JOIN category c ON a.category_id = c.id
        WHERE a.status = 'published'
        ORDER BY a.create_time DESC
        LIMIT #{limit}
    </select>

    <!-- 查询文章归档 -->
    <select id="selectArchives" resultType="map">
        SELECT DISTINCT DATE_FORMAT(create_time, '%Y') as year,
               COUNT(*) as count
        FROM article
        WHERE status = 'published'
        GROUP BY DATE_FORMAT(create_time, '%Y')
        ORDER BY year DESC
    </select>

    <!-- 按状态统计文章数量 -->
    <select id="countByStatus" resultType="java.lang.Long">
        SELECT COUNT(*) FROM article WHERE status = #{status}
    </select>

    <!-- 统计总阅读量 -->
    <select id="totalViews" resultType="java.lang.Long">
        SELECT SUM(views) FROM article
    </select>

</mapper>
